---

title: QuickTime – Jak dostosować instalację.
date: '2009-06-25T02:08:00.000+02:00'
author: kaarol
tags:
- SCCM
modified_time: '2015-03-03T21:22:37.974+01:00'
blogger_id: tag:blogger.com,1999:blog-1272990746006552071.post-8852603131150807508
blogger_orig_url: http://www.it-flow.pl/2009/06/quicktime-jak-dostosowac-instalacje.html
---

Aktualnie przygotowuje sobie paczki dla SCCM. Co prawda narazie testowo ale wszelkie znaki na niebie wskazują, że będę go wdrażał w swoim środowisku :)<br /><br />Podczas przygotowania kilkunastu paczek, które muszą mieć odpowiednio zmodyfikowany instalator natknąłem się nad kilka rodzynków. Paczką, która najbardziej dała mi w kość był&nbsp; QuickTime. W sumie uparłem się by zmodyfikować jego instalator a nie tworzyć nową paczkę za pomocą WinInstall LE:). Poniżej opis jak stworzyć paczkę, którą da się wypchnąć przez SCCM.<br /><ol><br /><li> Po pobraniu najnowszego instalatora QuickTime należy plik <em>quicTimeInstaller.exe</em> rozpakować za pomocą 7zipa. Od teraz będzie nas interesował tylko plik <em>QuickTime.msi</em>.<br /><br /><em>Ewentualnie podczas instalacji można wyszukać sobie odpowiedni plik w katalogu Temp aktualnie zalogowanego użytkownika (c:\Document and Settings\użytkownik\Ustawienia lokalne\Temp\losowykatalog\QuickTime.msi).</em></li><br /><li>Otwieramy pakiet MSI za pomocą <a href="http://msdn.microsoft.com/en-us/library/aa370557(VS.85).aspx">Orca</a> i na samym początku z menu <em>View</em> wybieramy <em>Summary Information…</em></li><br /><li>W nowym oknie w polu Language pozostawiamy tylko numerek 1033 (język angielski)</li><br /><li> Potem tworzymy sobie nowy plik odpowiedzi (Transform-&gt;New Transform)</li><br /><li>Teraz możemy modyfikować nasz pakiet:)<br /><ul><br /><li>Na samym początku w tabeli <em>LaunchCondidions</em> musimy usunąć wpis <strong>“NOT BNEWERPRODUCTISINSTALLED “</strong>. Jeśli ten wpis nie zostanie usunięty to pakiet msi będzie twierdził, że w systemie jest nowsza wersja QuickTime i odmówi instalacji<br /><br /><img alt="image" border="0" src="http://it-flow.pl/wp-content/uploads/2009/06/image-thumb1.png" height="15" style="border-bottom: 0px; border-left: 0px; border-right: 0px; border-top: 0px; display: block; float: none; margin-left: auto; margin-right: auto;" title="image" width="244" /></li><br /><li> Jeśli chcemy usunąć dodatkowego skrótu z pulpitu oraz wyłączyć autoupdate to&nbsp; w tabeli <em>Property</em> zmieniamy wartość wpisów <em>REGSRCH_DESKTOP_SHORTCUTS,&nbsp; QT_TRAY_ICON, SCHEDULE_ASUW</em> na wartość <strong>0</strong>. Natomiast wartość <em>AdminProperties</em> ustawiamy na: <strong>PROGRAMMENUNAME;QTJAVADIR;QTPROGRAMMENUFOLDERNAME </strong>a wartość <em>SecureCustomProperties</em><strong> </strong>na <strong>BNEWERPRODUCTISINSTALLED;EXISTINGINSTALLDIR;EXISTINGPROGRAMMENUNAME;<br />EXISTINGQTCOMPONENTS;EXISTINGQTEXTENSIONS;EXISTINGQTJAVADIR;EXISTINGQTSYSTEM;<br />INSTALLDIR;ISACTIONPROP1;ITUNES70_801_INSTALLED;PROGRAMMENUNAME;<br />QT7PP1INSTALLED;QTINFO.BISQTPRO;QTINFO.BITUNESHELPERRUNNING;<br />QTINFO.BNEWERQTISINSTALLED;QTINFO.BOLDERQTISINSTALLED;<br />QTINFO.BQTISINSTALLED;QTINFO.BSETDONOTLOADFROMBUILDRESULTS;<br />QTINFO.BUPGRADEWOULDINVALIDATEPROKEY;QTINFO.BUYQTPROURL;<br />QTINFO.CURRENTQTINSTALLPATH;QTINFO.CURRENTQTMACVERSNUM_BASE10;<br />QTINFO.CURRENTQTPROCESSCOUNT;QTINFO.CURRENTQTVERSNUM;<br />QTINFO.CURRENTQTVERSNUM_BASE10;QTINFO.CURRENTQTVERSSTR;<br />QTINFO.EXISTINGQTVERSNUM;QTINFO.EXISTINGQTVERSSTR;QTINFO.QTPROREGNAME;<br />QTINFO.QTPROREGNUMBER;QTJAVADIR;QTPLUGINOCXFOLDER;QTPROGRAMMENUFOLDERNAME;<br />REGSRCH_ITUNESHELPER_PATH;UPGRADEFOUND;UPGRADING750;UPGRADING755</strong></li><br /><li>Jeśli chcesz by skróty QuickTime wgrały się do odpowiedniego katalogu w menu start to należy w tabeli <em>CustomAction </em>zmodyfikować cel akcji <em>SET_PROGRAMMENUNAME</em> na np. <strong>Multimedia\ </strong><strong><br /></strong></li><br /><li><br /><div>W tabeli <em>Shortcut</em> mamy możliwość dodać lub usunąć nowe skróty, które potworzy instalator<br /><br /></div></li></ul></li><br /><li>Po modyfikacjach generujemy sobie plik odpowiedzi (TRANSFORM-&gt;Generate Transforms)</li><br /><li>W SCCM tworzymy nową paczkę, jako komendę do uruchomienia instalatora programu&nbsp; wklepujemy: <em>msiexec /i QuickTime.msi TRANSFORMS=install.mst /qb</em></li><br /><li>To byłoby na tyle:)</li></ol><br />P.S.<br /><br />Sorry za ten długi klucz na środku ale nie pamiętam, które atrybuty z niego usunąłem :(