---

title: "[En] Mounting directory inside container and SELinux"
date: '2017-06-05T22:06:00.000+02:00'
author: kaarol
tags:
- SELinux
- docker
- CentOS
modified_time: '2017-06-06T07:50:49.791+02:00'
blogger_id: tag:blogger.com,1999:blog-1272990746006552071.post-2321737285468242769
blogger_orig_url: http://www.it-flow.pl/2017/06/en-mounting-directory-inside-container.html
---

<table cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://www.docker.com/sites/default/files/whale_0.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" data-original-height="472" data-original-width="520" height="160" src="https://www.docker.com/sites/default/files/whale_0.png" width="200" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Picture from&nbsp;<a href="http://www.docker.com/">www.docker.com</a></td></tr></tbody></table>Using CoreOS for daily basic sometimes lull you in a false sense of security. Everything or almost everything is working and you don't care what is behind the magic. Switching the system from time to time could be painful. Especially when you come back to CentOS or RHEL and you don't want to disable SELinux. Below one of problems that you can hit when you mount folder inside container.<br /><br />Problem was quite trivial:<br />I would like to run the docker that will map the journal folder (/run/systemd/journal) as a docker volume for my image. Unfortunately after ran:<br /><pre style="background-color: #f6f8fa; border-radius: 3px; box-sizing: border-box; color: #24292e; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-stretch: normal; line-height: 1.45; margin-bottom: 16px; overflow: auto; padding: 16px; word-wrap: normal;"><code style="background: transparent; border-radius: 3px; border: 0px; box-sizing: border-box; display: inline; font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; line-height: inherit; margin: 0px; overflow: visible; padding: 0px; word-break: normal; word-wrap: normal;">docker run \<br />  -v /run/systemd/journal:/run/systemd/journal:ro \<br />  --name journal-test</code></pre>I've got a <i>Permission denied</i> in the journalctl. Fortunately in man for docker-run everything is very clearly described:<br /><script src="https://gist.github.com/kaarolch/474c1fd9eb5cf6a0b68ed61f47f32a60.js"></script>So the solution was to run docker with the :z option provided:<br /><pre style="background-color: #f6f8fa; border-radius: 3px; box-sizing: border-box; color: #24292e; font-size: 13.6px; font-stretch: normal; line-height: 1.45; margin-bottom: 16px; overflow: auto; padding: 16px; word-wrap: normal;"><code style="background: transparent; border-radius: 3px; border: 0px; box-sizing: border-box; display: inline; font-size: 13.6px; line-height: inherit; margin: 0px; overflow: visible; padding: 0px; word-break: normal; word-wrap: normal;">docker run \<br />  -v /run/systemd/journal:/run/systemd/journal:ro,z \<br />  --name journal-test</code></pre>Please remember that the ro and z should be separated by comma.<br />After some more investigation I found the post created by SELinux guru <a href="http://www.projectatomic.io/blog/2015/06/using-volumes-with-docker-can-cause-problems-with-selinux/">Using Volumes with Docker can Cause Problems with SELinux</a>. There is quite nice explanation of labels used by the docker and how the suffix <b>:z</b> and <b>:Z</b> works.
